<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Meu Site</title>
</head>

<!-- insert into templates/index.html (somewhere in the body) -->
<h2>Network tools (test)</h2>
<form action="/ping" method="get">
  Host to ping: <input type="text" name="host" value="8.8.8.8">
  <button type="submit">Ping (GET)</button>
</form>

<form action="/ping" method="post">
  Host to ping (POST): <input type="text" name="host" value="8.8.8.8">
  <button type="submit">Ping (POST)</button>
</form>

<!-- WARNING: only for local testing. Do NOT deploy to production. -->
<h2>Insecure Deserialization (Test)</h2>

<!-- textarea para colar payload base64 ou texto simples -->
<form id="pickle-form" action="/vuln-pickle" method="post">
  <label for="payload_text">Plain text to encode (optional):</label><br>
  <textarea id="payload_text" rows="4" cols="60" placeholder="Type Python representation or text"></textarea><br>

  <button type="button" id="encode-btn">Encode to base64 & fill payload</button><br><br>

  <label for="payload_b64">Base64-encoded pickle payload (or leave blank to auto-fill):</label><br>
  <textarea id="payload_b64" name="payload_b64" rows="6" cols="60" placeholder="Paste base64 here or use Encode button"></textarea><br>

  <small style="color:darkred;">
    WARNING: This endpoint is intentionally vulnerable and can allow RCE. Use only in isolated test env.
  </small><br><br>

  <button type="submit">Send payload (POST)</button>
</form>

<script>
/*
  This helper will base64-encode the plain text you type (note: not a real pickle binary generator).
  Use it to quickly create test strings (for demo). For real pickle payloads, generate the base64 on server/test machine.
*/
document.getElementById('encode-btn').addEventListener('click', function () {
  const txt = document.getElementById('payload_text').value || '';
  // encode as UTF-8 bytes, then base64
  const b64 = btoa(unescape(encodeURIComponent(txt)));
  document.getElementById('payload_b64').value = b64;
});
</script>

<!-- quick link for scanner discovery -->
<p><a href="/ping?host=8.8.8.8">Quick ping link</a></p>


<body>
  <h1>Menu dos cachorros</h1>
  <ul>
    <header>Menu</header>
    <li><a href="/labrador">Labrador</a></li>
    <li><a href="/border">Border Collie</a></li>
  </ul>
</body>
</html>

